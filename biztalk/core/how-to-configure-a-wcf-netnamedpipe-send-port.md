---
title: "How to Configure a WCF-NetNamedPipe Send Port | Microsoft Docs"
ms.custom: ""
ms.date: "06/08/2017"
ms.prod: "biztalk-server"
ms.reviewer: ""

ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: 57684e09-1f72-4bde-976c-3fcec65dc182
caps.latest.revision: 13
author: "MandiOhlinger"
ms.author: "mandia"
manager: "anneta"
---
# How to Configure a WCF-NetNamedPipe Send Port
You can configure a WCF-NetNamedPipe send port either programmatically or by using the BizTalk Administration console.  

## Configuration properties

 The BizTalk Explorer Object Model exposes an adapter-specific interface for send ports named **ITransportInfo** that has the **TransportTypeData** read/write property. This property accepts a WCF-NetNamedPipe send port configuration property bag in the form of a name-value pair of XML strings.  

 The **TransportTypeData** property of the **ITransportInfo** interface is not required. If it is not set, the adapter uses the default values for the WCF-NetNamedPipe send port configuration, as indicated in the following table.  

 The following table lists the configuration properties you can set in the BizTalk Explorer Object Model for WCF-NetNamedPipe send ports.  


|               Property name                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|--------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|         <strong>Identity</strong>          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     XML Blob<br /><br /> Example :<br /><br /> &lt;identity&gt;<br /><br /> &lt;userPrincipalName value="username@contoso.com" /&gt;<br /><br /> &lt;/identity&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Specify the identity of the service that this send port expects. These settings enable this send port to authenticate the service. In the handshake process between the client and service, the Windows Communication Foundation (WCF) infrastructure will ensure that the identity of the expected service matches the values of this element.<br /><br /> The default is an empty string.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|       <strong>StaticAction</strong>        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 String                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Specify the <strong>SOAPAction</strong> header field for outgoing messages. This property can also be set through the message context property <strong>WCF.Action</strong> in a pipeline or orchestration. You can specify this value in two different ways: the single action format and the action mapping format. If you set this property in the single action format- for example, <http://contoso.com/Svc/Op1-> the <strong>SOAPAction</strong> header for outgoing messages is always set to the value specified in this property.<br /><br /> If you set this property in the action mapping format, the outgoing <strong>SOAPAction</strong> header is determined by the <strong>BTS.Operation</strong> context property. For example, if this property is set to the following XML format and the <strong>BTS.Operation</strong> property is set to Op1, the WCF send adapter uses <http://contoso.com/Svc/Op1> for the outgoing <strong>SOAPAction</strong> header.<br /><br /> \<BtsActionMapping\><br /><br /> \<Operation Name="Op1" Action="<http://contoso.com/Svc/Op1>" /\><br /><br /> \<Operation Name="Op2" Action="<http://contoso.com/Svc/Op2>" /\><br /><br /> \</BtsActionMapping\><br /><br /> If outgoing messages come from an orchestration port, orchestration instances dynamically set the <strong>BTS.Operation</strong> property with the operation name of the port. If outgoing messages are routed with content-based routing, you can set the <strong>BTS.Operation</strong> property in pipeline components.<br /><br /> The default is an empty string. |
|        <strong>OpenTimeout</strong>        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <strong>System.TimeSpan</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Specify a time span value that indicates the interval of time provided for a channel open operation to complete.<br /><br /> Default value : 00:01:00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|        <strong>SendTimeout</strong>        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <strong>System.TimeSpan</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Specify a time span value that indicates the interval of time provided for a send operation to complete. If you use a solicit-response send port, this value specifies a time span for the whole interaction to complete, even if the service returns a large message.<br /><br /> Default value: 00:01:00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|       <strong>CloseTimeout</strong>        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <strong>System.TimeSpan</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Specify a time span value that indicates the interval of time provided for a channel close operation to complete.<br /><br /> Default value: 00:01:00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|  <strong>MaxReceivedMessageSize</strong>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Specify the maximum size, in bytes, for a message (including headers) that can be received on the wire. The size of the messages is bounded by the amount of memory allocated for each message. You can use this property to limit exposure to denial of service (DoS) attacks.<br /><br /> Default value: 65536                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     <strong>EnableTransaction</strong>     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Specify whether a message is transmitted to the destination service and deleted from the MessageBox database in a transactional context using the <strong>WS-AtomicTransaction</strong> protocol.<br /><br /> Default value: <strong>False</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|    <strong>TransactionProtocol</strong>    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Enum<br /><br /> -   <strong>OleTransaction</strong><br />-   <strong>WS-AtomicTransaction</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Specify the transaction protocol to be used with this binding.<br /><br /> Default value: <strong>OleTransaction</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|       <strong>SecurityMode</strong>        |                                                                                                                                                                                                                                                                                                                                                                                                                                                Enum<br /><br /> -   <strong>None</strong>- This disables security.<br />-   <strong>Transport</strong>: - Security is provided using underlying transport based security. It is possible to control the protection level with this mode.                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Specify the type of security that is used.<br /><br /> Default value: <strong>Transport</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <strong>TransportProtectionLevel</strong>  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Enum<br /><br /> -   <strong>None</strong> - No protection.<br />-   <strong>Sign</strong> - Messages are signed.<br />-   <strong>EncryptAndSign</strong> - Messages are encrypted and signed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Specify protection level of the named pipe. Signing messages mitigates the risk of a third party tampering with the message while it is being transferred. Encryption provides data-level privacy during transport.<br /><br /> Default value: <strong>EncryptAndSign</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|   <strong>OutboundBodyLocation</strong>    |                                                                                                                                                                                                                                                      Enum<br /><br /> -   <strong>UseBodyElement</strong> - Use the BizTalk message body part to create the content of the SOAP <strong>Body</strong> element for an outgoing message.<br />-   <strong>UseTemplate</strong> - Use the template supplied in the <strong>OutboundXMLTemplate</strong> property to create the content of the SOAP <strong>Body</strong> element for an outgoing message.<br /><br /> For more information about how to use the <strong>OutboundBodyLocation</strong> property, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Specify the data selection for the SOAP <strong>Body</strong> element of outgoing WCF messages.<br /><br /> Default value: <strong>UseBodyElement</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|    <strong>OutboundXMLTemplate</strong>    |                                                                                                                                                                                                                                                                                                                                                                                                                                                    String<br /><br /> For more information about how to use the <strong>OutboundXMLTemplate</strong> property, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Specify the XML-formatted template for the content of the SOAP <strong>Body</strong> element of an outgoing message. This property is required if the <strong>OutboundBodyLocation</strong> property is set to <strong>UseTemplate</strong>.<br /><br /> The default is an empty string.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|    <strong>InboundBodyLocation</strong>    | Enum<br /><br /> -   <strong>UseBodyElement</strong> - Use the content of the SOAP <strong>Body</strong> element of an incoming message to create the BizTalk message body part. If the <strong>Body</strong> element has more than one child element, only the first element becomes the BizTalk message body part. This property is valid only for solicit-response ports.<br />-   <strong>UseEnvelope</strong> - Create the BizTalk message body part from the entire SOAP <strong>Envelope</strong> of an incoming message.<br />-   <strong>UseBodyPath</strong> - Use the body path expression in the <strong>InboundBodyPathExpression</strong> property to create the BizTalk message body part. The body path expression is evaluated against the immediate child element of the SOAP <strong>Body</strong> element of an incoming message. This property is valid only for solicit-response ports.<br /><br /> For more information about how to use the <strong>InboundBodyLocation</strong> property, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md). |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Specify the data selection for the SOAP <strong>Body</strong> element of incoming WCF messages.<br /><br /> Default value: <strong>UseBodyElement</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <strong>InboundBodyPathExpression</strong> |                                                                                                                                                                                                                                                                                                                                                                                                                                                      String<br /><br /> For more information about how to use the <strong>InboundBodyPathExpression</strong> property, see [WCF Adapters Property Schema and Properties](../core/wcf-adapters-property-schema-and-properties.md).                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Specify the body path expression to identify a specific part of an incoming message used to create the BizTalk message body part. This body path expression is evaluated against the immediate child element of the SOAP <strong>Body</strong> node of an incoming message. If this body path expression returns more than one node, only the first node is chosen for the BizTalk message body part. This property is required if the <strong>InboundBodyLocation</strong> property is set to <strong>UseBodyPath</strong>. This property is valid only for solicit-response ports.<br /><br /> The default is an empty string.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|    <strong>InboundNodeEncoding</strong>    |                                                                                                                                                                                                                                                                                                                                                            Enum<br /><br /> -   <strong>XML</strong><br />-   <strong>Base64</strong> - Base64 encoding.<br />-   <strong>Hex</strong> - Hexadecimal encoding.<br />-   <strong>String</strong> - Text encoding - UTF-8.<br />-   <strong>XML</strong> - The WCF adapters create the BizTalk message body with the outer XML of the node selected by the body path expression in <strong>InboundBodyPathExpression</strong>.                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Specify the type of encoding that the WCF-NetNamedPipe send adapter uses to decode for the node identified by the body path specified in <strong>InboundBodyPathExpression</strong>. This property is required if the <strong>InboundBodyLocation</strong> property is set to <strong>UseBodyPath</strong>. This property is valid only for solicit-response ports.<br /><br /> Default value: <strong>XML</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|   <strong>PropagateFaultMessage</strong>   |                                                                                                                                                                                                                                                                                                                                                                                                                    Boolean<br /><br /> -   <strong>True</strong> - Route the message that fails outbound processing to a subscribing application (such as another receive port or orchestration schedule).<br />-   <strong>False</strong> - Suspend failed messages and generate a negative acknowledgment (NACK).                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Specify whether to route or suspend messages failed in outbound processing.<br /><br /> This property is valid only for solicit-response ports.<br /><br /> Default value: <strong>True</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

## Configure a WCF-NetNamedPipe Send Port with the BizTalk Administration Console

 You can set WCF-NetNamedPipe send port adapter variables in the BizTalk Administration console. If properties are not set for the send port, the default values for the WCF-NetNamedPipe send port configuration are used, as indicated in the previous table.  

## Configure variables for a WCF-NetNamedPipe send port  

1. In the BizTalk Administration console, create a new send port or double-click an existing send port to modify it. For more information, see [How to Create a Send Port](../core/how-to-create-a-send-port2.md). Configure all of the send port options and specify **WCF-NetNamedPipe** for the **Type** option in the **Transport** section of the **General** tab.  

2. On the **General** tab, in the **Transport** section, click the **Configure** button next to **Type**.  

3. In the <strong>WCF-NetNamedPipe Transport Properties</strong> dialog box, on the <strong>General</strong> tab, configure the endpoint address, the service identity, and the <strong>SOAPAction</strong> header for the WCF-NetNamedPipe send port. For more information about the <strong>General</strong> tab in the <strong>WCF-NetNamedPipe Transport Properties</strong> dialog box, see the <strong>WCF-NetNamedPipe Transport Properties Dialog Box, Send, General</strong> tab [!INCLUDE [ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)].

4. In the <strong>WCF-NetNamedPipe Transport Properties</strong> dialog box, on the <strong>Binding</strong> tab, configure the time-out and transaction properties. For more information about the <strong>Binding</strong> tab in the <strong>WCF-NetNamedPipe Transport Properties</strong> dialog box, see the <strong>WCF-NetNamedPipe Transport Properties Dialog Box, Send, Binding</strong> tab [!INCLUDE [ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)].

5. In the <strong>WCF-NetNamedPipe Transport Properties</strong> dialog box, on the <strong>Security</strong> tab, define the security capabilities of the WCF-NetNamedPipe send port. For more information about the <strong>Security</strong> tab in the <strong>WCF-NetNamedPipe Transport Properties</strong> dialog box, see the <strong>WCF-NetNamedPipe Transport Properties Dialog Box, Send, Security</strong> tab [!INCLUDE [ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)].

6. In the <strong>WCF-NetNamedPipe Transport Properties</strong> dialog box, on the <strong>Messages</strong> tab, specify the data selection for the SOAP <strong>Body</strong> element. For more information about the <strong>Messages</strong> tab in the <strong>WCF-NetNamedPipe Transport Properties</strong> dialog box, see the <strong>WCF-NetNamedPipe Transport Properties Dialog Box, Send, Messages</strong> tab [!INCLUDE [ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)].

## Configure a WCF-NetNamedPipe Send Port Programmatically

 You can use the following format to set the properties:  

```  
<CustomProps>  
  <TransportProtectionLevel vt="8">EncryptAndSign</TransportProtectionLevel>  
  <TransactionProtocol vt="8">OleTransactions</TransactionProtocol>  
  <InboundBodyPathExpression vt="8" />  
  <PropagateFaultMessage vt="11">-1</PropagateFaultMessage>  
  <CloseTimeout vt="8">00:01:00</CloseTimeout>  
  <OutboundBodyLocation vt="8">UseBodyElement</OutboundBodyLocation>  
  <StaticAction vt="8">http://www.northwindtraders.com/Service/Operation</StaticAction>  
  <SendTimeout vt="8">00:01:00</SendTimeout>  
  <InboundNodeEncoding vt="8">Xml</InboundNodeEncoding>  
  <EnableTransaction vt="11">0</EnableTransaction>  
  <SecurityMode vt="8">Transport</SecurityMode>  
  <InboundBodyLocation vt="8">UseBodyElement</InboundBodyLocation>  
  <OpenTimeout vt="8">00:01:00</OpenTimeout>  
  <OutboundXmlTemplate vt="8"><bts-msg-body xmlns="http://www.microsoft.com/schemas/bts2007" encoding="xml"/></OutboundXmlTemplate>  
  <MaxReceivedMessageSize vt="3">2097152</MaxReceivedMessageSize>  
</CustomProps>  

```  

 The following code fragment illustrates creating a WCF-NetNamedPipe send port:  

```  
// Use BizTalk Explorer object model to create new WCF-NetNamedPipe send port.  
string server = System.Environment.MachineName;  
string database = "BizTalkMgmtDb";  
string connectionString = string.Format("Server={0};Database={1};Integrated Security=true", server, database);  
string transportConfigData = @"<CustomProps>  
                                 <StaticAction vt=""8"">http://www.northwindtraders.com/Service/Operation</StaticAction>  
                                 <OpenTimeout vt=""8"">00:01:00</OpenTimeout>  
                               </CustomProps>";  
//requires project reference to \Program Files\Microsoft BizTalk Server 2009\Developer Tools\Microsoft.BizTalk.ExplorerOM.dll  
BtsCatalogExplorer explorer = new Microsoft.BizTalk.ExplorerOM.BtsCatalogExplorer();  
explorer.ConnectionString = connectionString;  
// Add a new BizTalk application  
Application application = explorer.AddNewApplication();  
application.Name = "SampleBizTalkApplication";  
// Save  
explorer.SaveChanges();  

// Add a new static one-way send port  
SendPort sendPort = application.AddNewSendPort(false, false);   
sendPort.Name = "SampleSendPort";  
sendPort.PrimaryTransport.TransportType = explorer.ProtocolTypes["WCF-NetNamedPipe"];  
sendPort.PrimaryTransport.Address = "net.pipe://mycomputer/private/samplequeue";  
sendPort.PrimaryTransport.TransportTypeData = transportConfigData; // propertyData; // need to change  
sendPort.SendPipeline = explorer.Pipelines["Microsoft.BizTalk.DefaultPipelines.PassThruTransmit"];  
// Save  
explorer.SaveChanges();  
```  

## See Also  
 [WCF Adapters Property Schema and Properties](../core/wcf-adapters-property-schema-and-properties.md)   
 [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md)   
 [Installing Certificates for the WCF Adapters](../core/installing-certificates-for-the-wcf-adapters.md)   
 [Configuring the WCF-NetNamedPipe Adapter](../core/configuring-the-wcf-netnamedpipe-adapter.md)   
 [Configuring Dynamic Send Ports Using WCF Adapters Context Properties](../core/configuring-dynamic-send-ports-using-wcf-adapters-context-properties.md)